from tensorflow.keras.models import load_model
import numpy as np
#Single test data only for debug validation only
SINGULAR_TEST_ROW = [0.09670284016410256,0.14532166669595165,0.1928357412991141,0.23328446763525104,0.033270739669059086,0.08445151727213382,0.13982443774771472,0.1968103592429913,0.041753593292472455,0.18124575798301376,0.1774836733002935,0.14623954391792662,0.06335076912278559,0.17767952108269333,0.16044586167522365,0.05170035594392565,0.10274210197830752,0.1469614925162215,0.0705829345464276,0.06410291178788625,0.08949231084515294,0.13624301192932067,0.11050744075820307,0.09602482158142513,0.09048593985883255,0.06624461502184027,0.11724857072696845,0.09830185561274983,0.07503077988013537,0.05143602002998734,0.0963929362389041,0.11547139986785078,0.08650120994328825,0.0760708988405111,0.10300902119745692,0.15078439645207764,0.04805446316729852,0.04153620400314787,0.032493003531389286,0.15153394289475539,0.05525469568746292,0.030074521384681183,0.045348224461799515,0.16118611282654643,0.12207400850757633,0.08663052217318042,0.08044990929228872,0.1919834360406034,0.018782962126972585,0.017551584054473813,0.049833277675094524,0.1883249073292462,0.03350636798993339,0.0336820574587663,0.2006983567652048,0.15649812858613035,0.11004113372378241,0.07706432358709803,0.22756742561702925,0.052166701030346305,0.056750950676635444,0.08705834031976942,0.22074395943895447,0.05714127341851714,0.07334205324014002,0.051867916581029155,0.1069568685872748,0.1638870361161387,0.041630487881705175,0.14883584549682008,0.1453767135097695,0.11366296685158918,0.05496905509807683,0.14471922880942156,0.12830380899510505,0.055427859739895155,0.11241223459600032,0.07107331638529749,0.1066781555744075,0.10485655802238279,0.07224597264731412,0.06643099319592538,0.09937037309936149,0.08844917438852443,0.05699013434568234,0.12322494592777637,0.06810370656085146,0.06969181963831131,0.045367813777391866,0.11281456410333582,0.05554431013007783,0.05856529868986047,0.1786946529544873,0.06513859263625969,0.07135859477366192,0.0729030384981198,0.1660338349015064,0.05108675083793214,0.07378942817360053,0.1773737667361558,0.1751043302913639,0.14245359613877703,0.022288587397975422,0.1704435256760953,0.1583254607451356,0.007030340987891445,0.03526301125154194,0.17240059390664159,0.015232472877370371,0.02128900745279847,0.03266910071665057,0.1709863973570474,0.020531279818152576,0.01707335752381007,0.13850680244938263,0.032733853630039486,0.01634212382196736,0.16381331590332943,0.15478036985091884,0.025232103999392887]
SINGULAR_POINT = [0.021822521216514547,0.029557978459252968,0.05456009575093399,0.08287292022636437,0.12015012362106932,0.18866710972649445,0.23175666895163954,0.26687031384797716,0.15472365483101766,0.10976496043703203,0.09174387200788692,0.08503985140095179,0.15017360389883375,0.10175585127840234,0.07670379625951068,0.021052066606624238,0.05355284433190241,0.08284871746403345,0.13452043432857191,0.20036983663214092,0.24207082011052453,0.27612133367998815,0.16843781247680076,0.10988088908563727,0.07923253826049154,0.07010387323528891,0.16205271351861136,0.09764234603775412,0.06367075584338053,0.03270179650104364,0.06188893775040715,0.1196792552902043,0.18289994342362423,0.22362568800337979,0.25706868299667796,0.15265032325944214,0.08886770649114716,0.06228593782296812,0.05560079016626253,0.14493825736941368,0.07681934247913903,0.04715519537239,0.029350742898971553,0.09624106515759424,0.15403305789817318,0.1931953233883733,0.225805505765494,0.12677385270946748,0.05647544147701674,0.04936499650491394,0.05066927854239403,0.11700153694031505,0.047329739241111224,0.039498556527283235,0.08490298948456013,0.132533550290007,0.16885934789125898,0.19997274336587384,0.11035467580963873,0.0271477041683836,0.05048100522158373,0.05904534211279699,0.09784210433470258,0.024073396560735292,0.04949001280195144,0.07140888199029004,0.11646442439684697,0.15333531997057898,0.034759711766318424,0.084240174272057,0.13524898684608036,0.1424105078174516,0.03514043510981733,0.10250008474631453,0.13184156139429573,0.04524705562516701,0.0823876496548276,0.03857002327220928,0.11706352068893607,0.17986933739727928,0.19067160402423283,0.038495339302932974,0.13976002738160717,0.18183089819583328,0.03721145511655274,0.08371272149980358,0.14905192511536974,0.21249784866839883,0.22455298003642765,0.08244917128968797,0.1714673860657353,0.21680053279642045,0.12090634324350154,0.1779641578412559,0.2405258684425257,0.25327299662600966,0.11888818791766774,0.19964197183133095,0.24635854493366538,0.1020415806862143,0.16042836971177443,0.16934857040425388,0.017306426284385872,0.12336684627761546,0.159412406349919,0.06351973976464297,0.07555848696718855,0.0868953734374018,0.022734940205694176,0.06840729348370536,0.014070300508092737,0.1471222619262885,0.04104936922196139,0.015569549168077186,0.15681268146818472,0.05365670052812427,0.01117570526337362,0.10881355475690019,0.147300749985344,0.04766264691671676]
SINGULAR_PINCH = [0.04305551353639492,0.04935061502586901,0.0719246242222137,0.11336693443823265,0.11870184875119698,0.12959078624373704,0.1361061467544862,0.14434995291974453,0.1485006179961358,0.06922993819781009,0.040447099260488464,0.0397785826825343,0.15066529505093917,0.07898208866177717,0.04222385130471481,0.018956922904516196,0.049569905943643376,0.08910668537764194,0.16157137169939909,0.17255949407076968,0.17858175096902573,0.185833273008918,0.19145016211050203,0.10463991736390842,0.06472003578317072,0.07621668632158898,0.19250003422070128,0.10599759455950614,0.06330946646427288,0.030681701513157803,0.07104046674321018,0.16666637291778874,0.175117997393132,0.17944858008993003,0.1848631263052314,0.19378141565384693,0.0999380804126067,0.05764806184541576,0.07385524838246663,0.19201678466819133,0.09681338885213964,0.05507952899671054,0.04184647325151809,0.181722681110608,0.186396356009108,0.18812088061087096,0.19058936742543933,0.2043634437758608,0.10299971227627085,0.06181281105400386,0.08301278846971545,0.19835790227301492,0.09207057121988024,0.057734795379228106,0.21806013233958094,0.21988529352791616,0.21943754861393522,0.21922108094472217,0.23698917427503288,0.1328209354742431,0.0963329268479447,0.11859780854640528,0.22738639271735106,0.11555833965971786,0.09187514046520909,0.024945514048605226,0.041317819646730106,0.05977512622135677,0.03880507489995298,0.09112121380838507,0.12172993888553303,0.09949808203390394,0.05949524635367708,0.11609426215153751,0.1261850121323091,0.016557798732097305,0.03520480972013534,0.018930381560532783,0.08801457132207545,0.1247754048979011,0.10345942013424515,0.034551348549599764,0.11060513978669881,0.12904313205818208,0.0186647092326453,0.019757076258136563,0.08661661544937618,0.12633428419149087,0.10617293676698508,0.018666658506788104,0.1067765289426607,0.13038830386610434,0.03353243632926356,0.08762271212096998,0.1294547794964957,0.11100816566709382,0.008434316977180115,0.10425701914090184,0.13319571980138575,0.1044072528310574,0.14260111962829244,0.12162323461699713,0.02843232223119201,0.12564052316376162,0.14679810148116743,0.04265858504466359,0.029530748139589613,0.09548278430825975,0.025869118087438976,0.04602600958518962,0.022295841910769637,0.1370390079041754,0.041606878697776545,0.0044838735433119226,0.1181896249117109,0.04229940108422237,0.026775604904426552,0.11256487974802745,0.14084507588473996,0.04268902891863132]



import tensorflow as tf
import os
'''
Hand Gesture Recognizer


Instantiate by pointing at a .h5 model from keras (default defined)

Seperatealy call .initialise() to get it going.

'''

class handGestureRecognizer():
    def __init__(self, model_path='models/gesturemodel_four.h5'):
        self.model_path = model_path
        os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'  #Stop from spamming the terminal.. 
    def initialise(self):
        self.model = load_model(self.model_path)


    def predict(self, input_data):
        if self.model is None:
            raise ValueError("Model has not been initialized. Call initialise() method first.")
        input_data = np.array([input_data])  
        probabilities = self.model.predict(input_data,verbose=None)
        return probabilities



